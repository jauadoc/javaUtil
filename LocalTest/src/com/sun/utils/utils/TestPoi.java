package com.sun.utils.utils;
import java.io.ByteArrayInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.UnsupportedEncodingException;

import org.apache.poi.poifs.filesystem.DirectoryEntry;
import org.apache.poi.poifs.filesystem.POIFSFileSystem;


/**
 * poi处理word
 * @author sunx(765480365@qq.com)<br/>
 * @version V1.0.0<br/>
 * @see {@link }
 */

public class TestPoi {
    /**
     * 将html导出成word，附加html样式
     * @throws UnsupportedEncodingException
     */
    public static void getWord() throws UnsupportedEncodingException{
        //样式由于POI内部会替换掉，所以不生效，可进行特殊字符替换使其生效。
        StringBuffer html = new StringBuffer();
        html.append("<html>");
        html.append("<head>");
        html.append("<style type=\"text/css\">#threeCoursesDiv{corlr:red}</style>");
        html.append("</head>");
        html.append("<body>");
        html.append( "<div id='threeCoursesDiv' class='scroll-x'>    <div class='text-center formLabelBold font-lg'>     三课教育相关数据统计表     </div>    <div class='text-center width-1600'>         <span class='pull-left'>            单位：广西省监狱管理局        </span>        <span class='pull-right'>               年度：2016年        </span>     </div>    <table id='' class=' table-bordered table-hover dataTable noThPadding width-1600  '>            <thead>                               <tr id='theadType'>                            <td class='formLabelBold' rowspan='2'>       月份     </td>                    <td class='formLabelBold' colspan='7'>        思想教育    </td>                    <td class='formLabelBold' colspan='7'>        文化教育    </td>                    <td class='formLabelBold' colspan='7'>        技术教育    </td>                </tr>                            <tr id='theadTypeItem'>                            <td class='formLabelBold'>       课时    </td>                    <td class='formLabelBold'>       应到课人数    </td>                    <td class='formLabelBold'>       实到课人数    </td>                    <td class='formLabelBold'>       到课率    </td>                    <td class='formLabelBold'>       参加考试人数    </td>                    <td class='formLabelBold'>       及格人数    </td>                    <td class='formLabelBold'>       及格率    </td>                    <td class='formLabelBold'>       课时    </td>                    <td class='formLabelBold'>       应到课人数    </td>                    <td class='formLabelBold'>       实到课人数    </td>                    <td class='formLabelBold'>       到课率    </td>                    <td class='formLabelBold'>       参加考试人数    </td>                    <td class='formLabelBold'>       及格人数    </td>                    <td class='formLabelBold'>       及格率    </td>                    <td class='formLabelBold'>       课时    </td>                    <td class='formLabelBold'>       应到课人数    </td>                    <td class='formLabelBold'>       实到课人数    </td>                    <td class='formLabelBold'>       到课率    </td>                    <td class='formLabelBold'>       参加考试人数    </td>                    <td class='formLabelBold'>       及格人数    </td>                    <td class='formLabelBold'>       及格率    </td>                </tr>                    </thead>         <tbody>                                                                                                 <tr class='threeClassTbody'>                                <td>         1     </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>            </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                    </tr>                                                                                                <tr class='threeClassTbody'>                                <td>         2     </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>            </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                    </tr>                                                                                                <tr class='threeClassTbody'>                                <td>         3     </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>            </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                    </tr>                                                                                                <tr class='threeClassTbody'>                                <td>         4     </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>            </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                    </tr>                                                                                                <tr class='threeClassTbody'>                                <td>         5     </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>            </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                    </tr>                                                                                                <tr class='threeClassTbody'>                                <td>         6     </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>            </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                    </tr>                                                                                    <tr class='threeClassTbody'>                                    <td>       上半年    </td>                            <td>             </td>                            <td>             </td>                            <td>           </td>                            <td>           </td>                            <td>           </td>                            <td>           </td>                            <td>           </td>                            <td>           </td>                            <td>           </td>                            <td>           </td>                            <td>           </td>                            <td>           </td>                            <td>           </td>                            <td>           </td>                            <td>            </td>                            <td>             </td>                            <td>             </td>                            <td>             </td>                            <td>             </td>                            <td>           </td>                            <td>           </td>                        </tr>                        <tr class='threeClassTbody'>                                    <td>        备注     </td>                            <td colspan='21'>            </td>                        </tr>                                    <tr class='threeClassTbody'>                                <td>         7     </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>            </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                    </tr>                                                                                                <tr class='threeClassTbody'>                                <td>         8     </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>            </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                    </tr>                                                                                                <tr class='threeClassTbody'>                                <td>         9     </td>                        <td>        3     </td>                        <td>        15     </td>                        <td>       3    </td>                        <td>       20.0%    </td>                        <td>       12    </td>                        <td>       6    </td>                        <td>       50.0%    </td>                        <td>       3    </td>                        <td>       18    </td>                        <td>       18    </td>                        <td>       100.0%    </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>        4    </td>                        <td>        22     </td>                        <td>        16     </td>                        <td>        72.73%     </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                    </tr>                                                                                                <tr class='threeClassTbody'>                                <td>         10     </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>            </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                    </tr>                                                                                                <tr class='threeClassTbody'>                                <td>         11     </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>            </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                    </tr>                                                                                                <tr class='threeClassTbody'>                                <td>         12     </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>           </td>                        <td>            </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>             </td>                        <td>           </td>                        <td>           </td>                    </tr>                                                        <tr class='threeClassTbody'>                            <td>       下半年    </td>                    <td>        3     </td>                    <td>        15     </td>                    <td>       3    </td>                    <td>       20.0%    </td>                    <td>       12    </td>                    <td>       6    </td>                    <td>       50.0%    </td>                    <td>       3    </td>                    <td>       18    </td>                    <td>       18    </td>                    <td>       100.0%    </td>                    <td>           </td>                    <td>           </td>                    <td>           </td>                    <td>        4    </td>                    <td>        22     </td>                    <td>        16     </td>                    <td>        72.73%     </td>                    <td>             </td>                    <td>           </td>                    <td>           </td>                </tr>                <tr class='threeClassTbody'>                            <td>       全年    </td>                    <td>        3     </td>                    <td>        15     </td>                    <td>       3    </td>                    <td>       20.0%    </td>                    <td>       12    </td>                    <td>       6    </td>                    <td>       50.0%    </td>                    <td>       3    </td>                    <td>       18    </td>                    <td>       18    </td>                    <td>       100.0%    </td>                    <td>           </td>                    <td>           </td>                    <td>           </td>                    <td>        4    </td>                    <td>        22     </td>                    <td>        16     </td>                    <td>        72.73%     </td>                    <td>             </td>                    <td>           </td>                    <td>           </td>                </tr>         </tbody>    </table></div>");
        html.append("</body>");
        html.append("</html>");
        //创建流，将html字符串写入文档，并输出文档。
        POIFSFileSystem poifs = new POIFSFileSystem();
        DirectoryEntry directory = poifs.getRoot();
        ByteArrayInputStream bi = new ByteArrayInputStream(html.toString().getBytes("UTF-8"));
        try {
            directory.createDocument("WordDocument", bi);
            FileOutputStream fos = new FileOutputStream("C:\\测试文件.doc");
            poifs.writeFilesystem(fos);
            fos.flush();
            fos.close();
        } catch (IOException e) {

        }finally{

            try {
                bi.close();
                poifs.close();
            } catch (IOException e) {

            }
        }
    }
    public static void main(String[] args) throws UnsupportedEncodingException {
        getWord();
        System.out.println("run over");
    }
}
